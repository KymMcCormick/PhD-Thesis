---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
y <- vector()
x <- vector()
b <- function(r, n,f){
  for (i in r:n)
  y[i] <-    choose(n-1,i-1)*(1-f)^(i-1)*f^(n-i)/i
  # print(y)
  return(sum(y,na.rm = TRUE))
}
 
Ratioc2c3 <- function(n,f){
  for (i in 1:3)
    x[i] <- b(i,n,f)
  #print(x)
  #print(x[2]/(1-x[1]))
  #print((x[3]/(1-x[1]-x[2])))
    x[4] <- (x[2]/(1-x[1]))/(x[3]/(1-x[1]-x[2]))
  #print(x)
  return(x[4])
}

Ratioc3c2 <- function(n,f){
  for (i in 1:3)
    x[i] <- b(i,n,f)
  #print(x)
  #print(x[2]/(1-x[1]))
  #print((x[3]/(1-x[1]-x[2])))
    x[4] <- (x[3]/(1-x[1]-x[2]))/(x[2]/(1-x[1]))
  #print(x)
  return(x[4])
}

Ratioc2c3(5,0)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
```{r}
  s <- seq(0,1, by=.001)
test <- function(n){

for (i in 1:length(s)) 
  x[i] <- Ratioc2c3(n,s[i])
return(x)
}
v <- test(8)
plot(s, v, ylab="Ratio c(3)/c(2)", xlab = "f",type = "l")
v <- as.data.frame(v)
ggplot(v,aes(s,v))+
  geom_line()
optimise(f=Ratioc2c3, c(0,1), maximum = FALSE, n=8)

```

