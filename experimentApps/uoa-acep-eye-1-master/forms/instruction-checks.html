<form class="experimentForm" method="get">
  <div class="modal-header">
    <h4 class="modal-title">Verification Step</h4>
  </div>
  <div id="instructionsBody" class="modal-body">

    <div id="errorAlert" class="validationError hide">
      <div class="alert alert-warning fade in">
        <button type="button" class="close" data-dismiss="alert"
                aria-hidden="true">&times;</button>
        <span id="errorCount" class="badge"></span>
        &nbsp;
        <strong>Incorrect
          Answer(s):</strong>
        <span>Please correct your answers.</span>
      </div>
    </div>

    <p>
      Before proceeding we would like to verify that you have understood
      the Participant Information Statement and are qualified to proceed.
      If you fail to answer correctly, the experiment will start over where
      you can review the information statement once again.
    </p>

    <div class="q">
      <p>
        <label for="q1">
          1. When the study starts we will ask you to?
        </label>
        <span class="glyphicon glyphicon-exclamation-sign hide"
              data-toggle="tooltip"
              title="Missing answer"></span>
      </p>

      <div>
        <input type="radio" name="q1" value="1">
        &nbsp; Play a video game.
      </div>

      <div>
        <input type="radio" name="q1" value="2">
        &nbsp; Watch a short video clip.
      </div>

      <div>
        <input type="radio" name="q1" value="3">
        &nbsp; Upload a selfie to instagram.
      </div>
      <br>
    </div>

    <div class="q">
      <p>
        <label for="q2">
          2. You will also be shown?
        </label>
        <span class="glyphicon glyphicon-exclamation-sign hide"
              data-toggle="tooltip"
              title="Missing answer"></span>
      </p>

      <div>
        <input type="radio" name="q2" value="1">
        &nbsp; A map of the world.
      </div>

      <div>
        <input type="radio" name="q2" value="2">
        &nbsp; A collection of supermarket products.
      </div>

      <div>
        <input type="radio" name="q2" value="3">
        &nbsp; Photographs of faces.
      </div>
      <br>
    </div>

<div class="q">
      <p>
        <label for="q3">
          3. To ensure payment, you should:
        </label>
        <span class="glyphicon glyphicon-exclamation-sign hide"
              data-toggle="tooltip"
              title="Missing answer"></span>
      </p>

      <div>
        <input type="radio" name="q3" value="1">
        &nbsp; Finish the experiment and note down your completion code.
      </div>

      <div>
        <input type="radio" name="q3" value="2">
        &nbsp; Quit the experiment at any time.
      </div>

      <div>
        <input type="radio" name="q3" value="3">
         &nbsp; Hit the "Back" button.
      </div>
      <br>
    </div>

  </div>
  <div class="modal-footer">
    <span style="opacity: 0.6">Click here to proceed</span>
    <button id="continueButton" type="submit" class="btn btn-default" value="Continue">Continue</button>
  </div>
</form>

<script>
    // If the form is being submitted without the submitHandler being called
    // (evidenced by screen reloading with ?age=XX&gender=YY....
    // as part of the URL) the problem is often that the call to validate
    // below did not locate the appropriate form element.

    $('.experimentForm').validate({
        submitHandler: function (form) {
            console.log("submit pressed");
            experiment.next();
        },
        onsubmit: true,
        debug: false,
        rules: {
          q1: { required: true, equals: "2" },
          q2: { required: true, equals: "3" },
          q3: { required: true, equals: "1" }
        },
        invalidHandler: function (event, defaultValidator) {
            console.log("invalid handler")
            // 'this' refers to the form
            var errors = defaultValidator.numberOfInvalids();

            if (errors) {
                console.log("about to handle error")
                experiment.currentStage.handleError();
            }
        }
    });

</script>
